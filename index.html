
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Abyss: A Black Hole Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0KOVEMVIARBEGivKRnIm3iHOKUVHTvLNXntZ5wHWiYmaubwlEVBCg" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGqsACqSwwwHI" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax5AS+fllcc/B9oVHCUSLXCHrDERoZoeDg" crossorigin="anonymous"></script>
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Start with overflow hidden for splash screen */
            background-image: url('https://images.unsplash.com/photo-1506318137071-a_8e063b4bec0?q=80&w=2093&auto=format&fit=crop');
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            color: #e2e8f0; /* Default light text color */
        }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 4px; border: 1px solid #0a0a0a;}
        ::-webkit-scrollbar-thumb:hover { background: #67e8f9; }

        /* --- New Splash Screen Styles --- */
        #splash-screen {
            position: fixed;
            inset: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 100;
            overflow: hidden;
            transition: opacity 1s ease-out;
            background: #000;
        }

        #bg-video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translateX(-50%) translateY(-50%);
            z-index: 1;
            opacity: 0.7;
            transition: opacity 0.5s ease-out;
        }

        #bg-video.hidden {
            opacity: 0;
        }

        #warp-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            opacity: 0;
            transition: opacity 1s ease-in;
        }
        
        #warp-canvas.visible {
            opacity: 1;
        }

        #white-flash {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 1px;
            height: 1px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            z-index: 3;
            transition: transform 1.5s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.5s ease-in;
        }

        #white-flash.expand {
            transform: translate(-50%, -50%) scale(3500);
            opacity: 1;
        }

        #prompt-text {
            transition: opacity 0.5s ease-out;
        }
        
        /* Main Content Styling */
        #main-content {
            display: none; /* Start as display:none, will be set to block via JS */
            opacity: 0;
            transition: opacity 1s ease-in;
            position: relative;
            z-index: 50; 
        }
        #main-content.visible {
            opacity: 1;
        }

         /* Detail Page Styling */
        #detail-page {
             display: none; /* Initially hidden */
             opacity: 0;
             transition: opacity 0.5s ease-in-out;
             position: relative;
             z-index: 60; /* Above main content */
             min-height: 100vh; /* Ensure it takes full height */
             padding-top: 8rem; /* Add padding to account for fixed header */
             background-color: rgba(0, 0, 0, 0.9); /* Dark background for detail page */
             backdrop-filter: blur(10px);
             padding-bottom: 4rem; /* Add padding at the bottom */
        }
        #detail-page.visible {
             display: block;
             opacity: 1;
        }

        /* --- Main Content & Animation Styles --- */
        .scroll-animated {
            opacity: 0;
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .scroll-animated.is-visible {
            opacity: 1;
            transform: translate(0, 0) !important;
        }

        @keyframes kenburns {
            from { transform: scale(1) translate(0, 0); }
            to { transform: scale(1.15) translate(-2%, 2%); }
        }
        
        .nav-link {
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: relative;
            transition: color 0.3s ease, transform 0.1s ease, background-color 0.3s ease;
            padding: 0.5rem 1rem;
            display: inline-block;
            border-radius: 6px;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 1px;
            bottom: 0.25rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: #67e8f9;
            transition: width 0.3s ease-in-out;
        }
        .nav-link:hover::after {
            width: calc(100% - 2rem);
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .nav-link:active {
            transform: scale(0.96);
            filter: brightness(0.9);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .logo-container svg {
            transition: transform 0.5s ease-in-out;
        }
        .logo-container:hover svg {
            transform: rotate(180deg);
        }

        .logo-container span {
            font-family: 'Orbitron', sans-serif;
            transition: transform 0.3s ease-in-out;
        }
        .logo-container:hover span {
            transform: scale(1.05);
        }
        
        .interactive-card {
            position: relative; /* Changed for absolute positioning of children */
            overflow: hidden;
            background-color: rgba(26, 32, 44, 0.5);
            border: 1px solid #2d3748;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
            min-height: 280px; /* Adjust if needed based on image aspect ratio */
            display: flex; /* Kept flex for potential future use */
            flex-direction: column; /* Kept flex for potential future use */
            cursor: pointer; /* Indicate it's clickable */
        }

        .interactive-card:hover {
            transform: translateY(-8px);
            border-color: rgba(103, 232, 249, 0.4);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(103, 232, 249, 0.2);
        }

        .interactive-card img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Cover the card area */
            transition: opacity 0.5s ease-in-out;
            z-index: 1; /* Image below content */
        }

        .interactive-card:hover img {
            opacity: 0.3; /* Dim the image on hover */
        }

        .card-content {
            position: absolute;
            inset: 0; /* Cover the entire card */
            background: rgba(0, 0, 0, 0.7); /* Dark overlay */
            padding: 1.5rem; /* Add padding inside */
            opacity: 0; /* Hidden by default */
            transition: opacity 0.5s ease-in-out;
            z-index: 2; /* Content above image */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center horizontally too */
            text-align: center; /* Center text within */
        }

        .interactive-card:hover .card-content {
            opacity: 1; /* Show content on hover */
        }
        
        .equation-display {
            color: #f0f0f0;
            font-size: 1rem;
            padding: 1rem 0.5rem;
            overflow-x: auto;
            white-space: nowrap;
            margin-top: 0.5rem; /* Space between title and equation */
            width: 100%; /* Ensure it takes available width for scrolling */
        }

        .equation-display::-webkit-scrollbar { height: 4px; }
        .equation-display::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 2px; }
        .equation-display::-webkit-scrollbar-thumb { background: #67e8f9; border-radius: 2px; }

         /* --- Styles for Interactive Equation (Detail Page) --- */
         .detail-equation-container {
            font-size: 2.5rem; /* Make equation larger */
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap; /* Allow wrapping */
            padding: 20px;
            background-color: rgba(10, 10, 10, 0.6);
            border-radius: 8px;
            backdrop-filter: blur(5px);
            margin-top: 2rem;
         }

        .detail-equation-container .op { /* Operator styling */
            margin: 0 0.5em;
            color: #9ca3af; /* Lighter gray for operators */
        }
        
        .detail-equation-container .term { /* Interactive term */
            position: relative; /* Required for the tooltip */
            cursor: help;
            border-bottom: 1px dotted rgba(103, 232, 249, 0.5); /* Cyan dotted underline */
            transition: background-color 0.2s ease-in-out;
            padding: 0 0.1em; /* Add slight padding */
        }

        .detail-equation-container .term:hover {
            background-color: rgba(103, 232, 249, 0.1); /* Cyan highlight */
        }
        
        .detail-equation-container .term::after { /* Tooltip box */
            content: attr(data-tooltip); 
            position: absolute;
            bottom: 130%; 
            left: 50%;
            transform: translateX(-50%);
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
            font-size: 0.8rem; /* Smaller font for tooltip */
            font-family: 'Inter', sans-serif; /* Standard font */
            font-weight: 400;
            padding: 10px 15px;
            border-radius: 6px;
            width: 320px; 
            text-align: left;
            line-height: 1.4;
            white-space: normal; /* Allow wrapping */
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .detail-equation-container .term:hover::after { /* Show tooltip */
            visibility: visible;
            opacity: 1;
        }

        .detail-equation-container .fraction { /* Fraction styling */
            display: inline-flex;
            flex-direction: column;
            text-align: center;
            margin: 0 0.3em;
            vertical-align: middle;
            font-size: 0.9em; 
        }

        .detail-equation-container .numerator {
            border-bottom: 2px solid white; /* White line */
            padding: 0 0.2em;
        }

        .detail-equation-container .denominator {
            padding: 0 0.2em;
        }

        .detail-equation-container sub, 
        .detail-equation-container sup { /* Sub/Sup styling */
            font-size: 0.7em;
            line-height: 0;
            color: #cbd5e1; /* Slightly lighter */
        }

        /* --- Styles for Simulation Section --- */
        #simulation-section {
            margin-top: 3rem;
            text-align: center;
        }
        .simulation-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        #mass-slider {
             width: 300px;
             cursor: pointer;
             /* Customizing slider appearance */
             height: 8px;
             border-radius: 4px;
             background: #4a5568; /* gray-600 */
             outline: none;
             opacity: 0.7;
             transition: opacity .2s;
             accent-color: #67e8f9; /* cyan-300 */
        }
         #mass-slider:hover {
              opacity: 1;
         }

        #mass-value {
             min-width: 50px; /* Ensure space for the value */
             text-align: right;
             font-family: 'Orbitron', sans-serif;
             color: #67e8f9;
        }

        #run-simulation-btn {
            background-color: #0e7490; /* cyan-700 */
            color: white;
            font-family: 'Orbitron', sans-serif;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: background-color 0.3s ease, transform 0.1s ease;
            cursor: pointer;
            border: none; /* Remove default border */
        }
        #run-simulation-btn:hover {
            background-color: #0891b2; /* cyan-600 */
        }
        #run-simulation-btn:active {
            transform: scale(0.98);
        }
        #simulation-loading {
            display: none; /* Hidden by default */
            margin-top: 1rem;
            color: #9ca3af;
        }
        #simulation-results {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: rgba(10, 10, 10, 0.4);
            border: 1px solid #2d3748;
            border-radius: 8px;
            min-height: 300px; /* Increased height */
            text-align: center; /* Center content initially */
            color: #cbd5e1;
            display: flex; /* Use flexbox to center image */
            justify-content: center;
            align-items: center;
        }
         #simulation-results img {
            max-width: 100%;
            max-height: 500px; /* Limit image height */
            border-radius: 4px;
         }
         #simulation-error {
             color: #f87171; /* red-400 */
             margin-top: 1rem;
             display: none; /* Hidden by default */
         }


    </style>
</head>
<body class="bg-black text-white">

    <div id="splash-screen">
        <video id="bg-video" autoplay muted loop playsinline>
            <!-- IMPORTANT: Replace this with the path to your video file -->
            <source src="videos/blackhole.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        
        <canvas id="warp-canvas" class="hidden"></canvas>
        <div id="white-flash"></div>
        <div id="prompt-text" class="absolute bottom-10 text-center text-gray-400 animate-pulse z-10">
            <p class="text-lg">Click anywhere to enter</p>
        </div>
    </div>

    <div id="main-content"> <!-- Main container for switchable content -->
        <header class="fixed top-0 left-0 w-full bg-black/50 backdrop-blur-sm z-50 border-b border-white/10 shadow-lg shadow-black/20">
            <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
                <a href="#" id="home-link" class="logo-container flex items-center space-x-3">
                    <svg width="32" height="32" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <path d="M 90,50 A 40,40 0 1,1 50,10" fill="none" stroke="#67e8f9" stroke-width="8" stroke-linecap="round"/>
                        <path d="M 70,50 A 20,20 0 1,1 50,30" fill="none" stroke="white" stroke-width="6" stroke-linecap="round"/>
                        <circle cx="50" cy="50" r="12" fill="black"/>
                    </svg>
                    <span class="text-2xl font-bold text-white tracking-wider">COSMIC ABYSS</span>
                </a>
                <div>
                    <a href="#about" class="nav-link text-gray-300 hover:text-cyan-300 text-sm font-medium">About</a>
                    <a href="#anatomy" class="nav-link text-gray-300 hover:text-cyan-300 text-sm font-medium">Anatomy</a>
                    <a href="#discoveries" class="nav-link text-gray-300 hover:text-cyan-300 text-sm font-medium">Discoveries</a>
                    <a href="#relativity" class="nav-link text-gray-300 hover:text-cyan-300 text-sm font-medium">Relativity</a>
                    <a href="#field-equations" class="nav-link text-gray-300 hover:text-cyan-300 text-sm font-medium">Field Equations</a>
                </div>
            </nav>
        </header>

        <!-- Container for the main sections -->
        <div id="main-sections-container"> 
            <main>
                <section class="h-screen flex items-center justify-center text-white text-center relative overflow-hidden">
                    <div class="absolute inset-0" style="background-image: url('https://images.unsplash.com/photo-1534796636912-3b95-b3ab5986?q=80&w=2071&auto=format&fit=crop'); background-size: cover; background-position: center; animation: kenburns 30s ease-in-out infinite alternate;"></div>
                    <div class="absolute inset-0 bg-black/60"></div>
                    <div class="relative z-10 p-4">
                        <div class="scroll-animated" style="transform: translateY(40px);">
                            <h2 class="text-5xl md:text-7xl font-black uppercase tracking-widest">Journey into the Singularity</h2>
                        </div>
                        <div class="scroll-animated" style="transform: translateY(40px); transition-delay: 200ms;">
                            <p class="mt-4 text-lg md:text-xl max-w-3xl mx-auto text-gray-300">Exploring the most enigmatic and powerful objects in the universe.</p>
                        </div>
                    </div>
                </section>
                
                <div class="bg-black/80 backdrop-blur-md py-20 text-gray-200">
                    <div class="container mx-auto px-6">
                        <section id="about" class="mb-20">
                            <div class="grid md:grid-cols-2 gap-12 items-center">
                                <div class="scroll-animated" style="transform: translateX(-40px);">
                                    <h3 class="text-4xl font-bold mb-4">What is a Black Hole?</h3>
                                    <p class="text-gray-400 leading-relaxed">
                                        A black hole is a region of spacetime where gravity is so strong that nothing—no particles or even electromagnetic radiation such as light—can escape from it. The theory of general relativity predicts that a sufficiently compact mass can deform spacetime to form a black hole.
                                    </p>
                                    <p class="text-gray-400 leading-relaxed mt-4">
                                        They are born from the remnants of massive stars that have exhausted their nuclear fuel and collapsed under their own gravity. This catastrophic event, known as a supernova, can leave behind a dense core that continues to collapse into an infinitely dense point called a singularity.
                                    </p>
                                </div>
                                <div class="scroll-animated" style="transform: translateX(40px); transition-delay: 200ms;">
                                    <img src="https://images.unsplash.com/photo-1614726353142-99a_52c04c53c?q=80&w=1974&auto=format&fit=crop" alt="Illustration of a black hole in space" class="rounded-lg shadow-2xl shadow-blue-500/20">
                                </div>
                            </div>
                        </section>

                        <section id="anatomy" class="mb-20 text-center">
                            <div class="scroll-animated" style="transform: translateY(40px);">
                                <h3 class="text-4xl font-bold mb-10">Anatomy of a Black Hole</h3>
                            </div>
                            <div class="grid md:grid-cols-3 gap-8">
                                <div class="scroll-animated" style="transform: translateY(40px);">
                                    <div class="interactive-card p-6 rounded-lg"> <!-- Removed cursor pointer here if not linking -->
                                        <h4 class="text-2xl font-bold text-cyan-400 mb-2">Singularity</h4>
                                        <p class="text-gray-400">At the center of a black hole is the singularity, a one-dimensional point which contains a huge mass in an infinitely small space, where density and gravity become infinite and spacetime curves infinitely.</p>
                                    </div>
                                </div>
                                <div class="scroll-animated" style="transform: translateY(40px); transition-delay: 200ms;">
                                    <div class="interactive-card p-6 rounded-lg"> <!-- Removed cursor pointer here if not linking -->
                                        <h4 class="text-2xl font-bold text-cyan-400 mb-2">Event Horizon</h4>
                                        <p class="text-gray-400">This is the "point of no return." It is the boundary around the singularity from which nothing can escape. Anything that crosses the event horizon is pulled in by the black hole's gravity forever.</p>
                                    </div>
                                </div>
                                <div class="scroll-animated" style="transform: translateY(40px); transition-delay: 400ms;">
                                    <div class="interactive-card p-6 rounded-lg"> <!-- Removed cursor pointer here if not linking -->
                                        <h4 class="text-2xl font-bold text-cyan-400 mb-2">Accretion Disk</h4>
                                        <p class="text-gray-400">A disk-like flow of gas, plasma, dust, or stars around the black hole. As material in the disk spirals inward, it heats up due to friction and emits vast amounts of energy, making the black hole's vicinity visible.</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        <section id="discoveries" class="mb-20 text-center">
                            <div class="scroll-animated" style="transform: translateY(40px);">
                                <h3 class="text-4xl font-bold mb-10">Latest Discoveries</h3>
                            </div>
                            <div class="scroll-animated" style="transform: translateY(40px);">
                                 <div class="interactive-card max-w-4xl mx-auto p-8 rounded-lg"> <!-- Removed cursor pointer here if not linking -->
                                     <h4 class="text-2xl font-bold text-amber-400 mb-4">First Image of a Black Hole</h4>
                                     <p class="text-gray-400 leading-relaxed">In 2019, the Event Horizon Telescope (EHT) collaboration captured the first-ever direct image of a black hole. They imaged the supermassive black hole at the center of the Messier 87 galaxy, revealing a bright ring of light surrounding a dark shadow—the event horizon. This monumental achievement provided visual confirmation of Einstein's theories and opened a new window into studying these cosmic giants.</p>
                                 </div>
                            </div>
                        </section>
                        
                        <section id="relativity" class="pt-10 mb-20">
                            <div class="scroll-animated" style="transform: translateY(40px);">
                                <h3 class="text-4xl font-bold mb-10 text-center">The General Theory of Relativity</h3>
                            </div>
                            <div class="grid md:grid-cols-2 gap-12 items-center text-left">
                                <div class="scroll-animated" style="transform: translateX(-40px);">
                                    <img src="https://images.unsplash.com/photo-1608611993252-5a3d38096a4e?q=80&w=2070&auto=format&fit=crop" alt="Spacetime curvature visualization" class="rounded-lg shadow-2xl shadow-cyan-500/20">
                                </div>
                                <div class="scroll-animated" style="transform: translateX(40px); transition-delay: 200ms;">
                                    <p class="text-gray-400 leading-relaxed">
                                        Developed by Albert Einstein in 1915, the General Theory of Relativity is one of the pillars of modern physics. It provides our current understanding of gravity. The core idea is that what we perceive as the force of gravity is actually the result of the **curvature of spacetime**.
                                    </p>
                                    <p class="text-gray-400 leading-relaxed mt-4">
                                        Massive objects, like stars and planets, warp the fabric of spacetime around them. Other objects then move along these curves, which we observe as orbits. For a black hole, the mass is so immense and concentrated that it warps spacetime to an extreme degree, creating a 'well' so deep that nothing, not even light, can escape.
                                    </p>
                                </div>
                            </div>
                        </section>

                        <section id="field-equations" class="pt-10 text-center">
                            <div class="scroll-animated" style="transform: translateY(40px);">
                                <h3 class="text-4xl font-bold mb-10">Foundational Field Equations</h3>
                            </div>
                            <div class="grid md:grid-cols-3 gap-8">
                                <!-- Einstein Card - Now a link -->
                                <div class="scroll-animated" style="transform: translateY(40px);">
                                    <a href="#einstein-detail" id="einstein-link">
                                        <div class="interactive-card rounded-lg">
                                            <img src="https://placehold.co/600x800/2D3748/E2E8F0?text=Einstein" alt="Albert Einstein" class="rounded-lg">
                                            <div class="card-content rounded-lg">
                                                <h4 class="text-2xl font-bold text-cyan-400 mb-2">Einstein's Field Equation</h4>
                                                <div class="equation-display"></div>
                                                <p class="text-gray-400 text-sm mt-2">Relates spacetime curvature with the distribution of matter and energy.</p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                 <!-- Schwarzschild Card -->
                                <div class="scroll-animated" style="transform: translateY(40px); transition-delay: 200ms;">
                                    <div class="interactive-card rounded-lg">
                                         <img src="https://placehold.co/600x800/2D3748/E2E8F0?text=Schwarzschild" alt="Karl Schwarzschild" class="rounded-lg">
                                        <div class="card-content rounded-lg">
                                            <h4 class="text-2xl font-bold text-cyan-400 mb-2">Schwarzschild Metric</h4>
                                            <div class="equation-display"></div>
                                            <p class="text-gray-400 text-sm mt-2">Describes gravity around a static, non-rotating spherical mass.</p>
                                        </div>
                                    </div>
                                </div>
                                 <!-- Kerr Card -->
                                <div class="scroll-animated" style="transform: translateY(40px); transition-delay: 400ms;">
                                    <div class="interactive-card rounded-lg">
                                        <img src="https://placehold.co/600x800/2D3748/E2E8F0?text=Kerr" alt="Roy Kerr" class="rounded-lg">
                                        <div class="card-content rounded-lg">
                                            <h4 class="text-2xl font-bold text-cyan-400 mb-2">Kerr Metric</h4>
                                            <div class="equation-display"></div>
                                            <p class="text-gray-400 text-sm mt-2">Describes the more complex geometry around a rotating mass.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </main>
            
            <footer class="bg-black/50 backdrop-blur-sm text-center py-6 mt-20">
                <p class="text-gray-500">&copy; 2025 Cosmic Abyss. A journey into the unknown.</p>
            </footer>
        </div> <!-- End of main-sections-container -->

        <!-- Detail Page Section (Initially Hidden) -->
        <div id="detail-page">
             <div class="container mx-auto px-6 text-center">
                 <a href="#main" id="back-to-main" class="absolute top-24 left-6 inline-block mb-8 text-cyan-400 hover:text-cyan-300 transition-colors">&larr; Back to Main</a>
                 <h2 class="text-5xl font-bold mb-10 text-white" style="font-family: 'Orbitron', sans-serif;">Einstein's Field Equation</h2>
                 
                 <!-- Interactive Equation Container -->
                 <div class="detail-equation-container max-w-4xl mx-auto shadow-lg">
                    <span class="term" data-tooltip="Ricci Curvature Tensor: Represents how the volume of a small ball of matter changes over time. It describes the tidal forces that curve spacetime.">
                        R<sub>&mu;&nu;</sub>
                    </span>
                    <span class="op">-</span>
                    <span class="fraction">
                        <span class="numerator">1</span>
                        <span class="denominator">2</span>
                    </span>
                    <span class="term" data-tooltip="Scalar Curvature (Ricci Scalar): A single number at each point in spacetime that represents the overall, average curvature.">
                        R
                    </span>
                    <span class="term" data-tooltip="Metric Tensor: The most crucial part! This tensor defines the geometry of spacetime itself. It tells us how to measure distances and time intervals.">
                        g<sub>&mu;&nu;</sub>
                    </span>
                    <span class="op">+</span>
                    <span class="term" data-tooltip="Cosmological Constant (Lambda): Represents the energy density of empty space (dark energy). Einstein first called it his 'biggest blunder,' but it's now essential for explaining the accelerating expansion of the universe.">
                        &Lambda;
                    </span>
                    <span class="term" data-tooltip="Metric Tensor: Defines the geometry of spacetime and how to measure distances and time intervals.">
                        g<sub>&mu;&nu;</sub>
                    </span>
                    <span class="op">=</span>
                    <span class="fraction">
                        <span class="numerator">
                            8&pi;
                            <span class="term" data-tooltip="Newton's Gravitational Constant: The fundamental constant that determines the strength of gravity.">G</span>
                        </span>
                        <span class="denominator">
                            <span class="term" data-tooltip="Speed of Light (to the 4th power): A conversion factor that relates mass-energy to the curvature of spacetime.">c<sup>4</sup></span>
                        </span>
                    </span>
                    <span class="term" data-tooltip="Stress-Energy-Momentum Tensor: This tensor describes the source of gravity. It includes all mass, energy, momentum, and pressure of all matter and radiation in spacetime.">
                        T<sub>&mu;&nu;</sub>
                    </span>
                 </div>
                 <p class="mt-6 text-gray-400 text-sm italic">Hover over the terms to see their meaning.</p>

                 <!-- Simulation Section -->
                 <div id="simulation-section">
                      <h3 class="text-3xl font-bold text-cyan-400 mb-4" style="font-family: 'Orbitron', sans-serif;">Spacetime Curvature Simulation</h3>
                      <div class="simulation-controls">
                          <label for="mass-slider" class="mr-2">Mass:</label>
                          <input type="range" id="mass-slider" name="mass" min="1" max="50" value="10" step="1">
                          <span id="mass-value">10.0</span>
                      </div>
                     <button id="run-simulation-btn">Generate Plot</button>
                     <div id="simulation-loading">Generating plot...</div>
                     <div id="simulation-error"></div> 
                     <div id="simulation-results">
                         <!-- Simulation image will appear here -->
                         Adjust the mass and click "Generate Plot" to see the visualization.
                     </div>
                 </div>

             </div>
        </div>

    </div> <!-- End of main-content -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM ELEMENTS ---
            const splashScreen = document.getElementById('splash-screen');
            const mainContent = document.getElementById('main-content');
            const mainSectionsContainer = document.getElementById('main-sections-container');
            const detailPage = document.getElementById('detail-page');
            const bgVideo = document.getElementById('bg-video');
            const promptText = document.getElementById('prompt-text');
            const warpCanvas = document.getElementById('warp-canvas');
            const whiteFlash = document.getElementById('white-flash');
            const ctx = warpCanvas ? warpCanvas.getContext('2d') : null; // Add null check
            const einsteinLink = document.getElementById('einstein-link');
            const backToMainLink = document.getElementById('back-to-main');
            const homeLink = document.getElementById('home-link'); // Logo link
            const runSimulationBtn = document.getElementById('run-simulation-btn');
            const simulationLoading = document.getElementById('simulation-loading');
            const simulationResults = document.getElementById('simulation-results');
            const massSlider = document.getElementById('mass-slider');
            const massValueSpan = document.getElementById('mass-value');
            const simulationError = document.getElementById('simulation-error');
            
            // --- WARP SPEED EFFECT ---
            let stars = [];
            const numStars = 2000;
            const speed = 25; // Increased speed
            let animationFrameId;

            function setupWarp() {
                // Ensure canvas exists before getting context
                if (!warpCanvas) return; 
                warpCanvas.width = window.innerWidth;
                warpCanvas.height = window.innerHeight;
                stars = [];
                for (let i = 0; i < numStars; i++) {
                    stars[i] = {
                        x: Math.random() * warpCanvas.width - warpCanvas.width / 2,
                        y: Math.random() * warpCanvas.height - warpCanvas.height / 2,
                        z: Math.random() * warpCanvas.width,
                    };
                }
            }
            
            function animateWarp() {
                // Ensure canvas context exists
                if (!ctx) return; 
                ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // Fading trail effect
                ctx.fillRect(0, 0, warpCanvas.width, warpCanvas.height);
                ctx.save();
                ctx.translate(warpCanvas.width / 2, warpCanvas.height / 2);

                for (let i = 0; i < numStars; i++) {
                    let star = stars[i];
                    star.z -= speed;
                    if (star.z < 1) {
                        star.z = warpCanvas.width;
                        star.x = Math.random() * warpCanvas.width - warpCanvas.width / 2;
                        star.y = Math.random() * warpCanvas.height - warpCanvas.height / 2;
                    }

                    const sx = (star.x / star.z) * warpCanvas.width;
                    const sy = (star.y / star.z) * warpCanvas.height;
                    
                    ctx.beginPath();
                    ctx.strokeStyle = 'white';
                    const px = (star.x / (star.z + speed)) * warpCanvas.width;
                    const py = (star.y / (star.z + speed)) * warpCanvas.height;
                    ctx.moveTo(px, py);
                    ctx.lineTo(sx, sy);
                    ctx.stroke();
                }
                ctx.restore();
                animationFrameId = requestAnimationFrame(animateWarp);
            }

             // Add resize listener only if warpCanvas exists
             if (warpCanvas) {
                window.addEventListener('resize', setupWarp);
             }


             // --- Page Switching Logic ---
             function showMainContent() {
                 detailPage.classList.remove('visible');
                 setTimeout(() => { // Wait for fade out
                     detailPage.style.display = 'none';
                     mainSectionsContainer.style.display = 'block'; 
                     // No need for opacity fade here as it was never hidden, just its container
                     window.scrollTo(0, 0); // Scroll to top
                 }, 500); // Match CSS transition duration
             }

             function showDetailPage() {
                 mainSectionsContainer.style.display = 'none'; // Hide main sections immediately
                 detailPage.style.display = 'block';
                 setTimeout(() => { // Allow display change before fading in
                      detailPage.classList.add('visible');
                      // No need to render equation here, it's plain HTML now
                      window.scrollTo(0, 0); // Scroll to top
                 }, 50);
             }


            // --- SPLASH SCREEN TRANSITION SCRIPT ---
             if (splashScreen) { // Check if splash screen exists
                 splashScreen.addEventListener('click', () => {
                     // 1. Hide initial elements.
                     if (bgVideo) bgVideo.classList.add('hidden'); // Check if elements exist
                     if (promptText) promptText.style.opacity = '0';
     
                     // 2. Setup and start warp animation.
                     setupWarp();
                      if (warpCanvas) {
                         warpCanvas.classList.remove('hidden'); // Ensure canvas is not display:none
                         animateWarp();
                     }
                     
                     // 3. Fade in the warp canvas.
                     setTimeout(() => {
                         if (warpCanvas) warpCanvas.classList.add('visible');
                     }, 500);
     
                     // 4. Trigger the white flash.
                     setTimeout(() => {
                        if (whiteFlash) whiteFlash.classList.add('expand');
                     }, 2000);
     
                     // 5. Transition to main content.
                     setTimeout(() => {
                         if (animationFrameId) cancelAnimationFrame(animationFrameId);
                         
                         splashScreen.style.opacity = '0';
                         mainContent.style.display = 'block'; // Correctly set display to block FIRST
                         
                         setTimeout(() => {
                             mainContent.classList.add('visible'); // THEN fade in main content
                             setupScrollAnimations();
                             renderMainEquations(); // Render KaTeX equations in main section
                         }, 50); // Small delay to allow display:block to apply
     
                         setTimeout(() => {
                             splashScreen.style.display = 'none';
                             document.body.style.overflow = 'auto'; // Re-enable scrolling
                         }, 1000); // Match splash screen fade out duration
     
                     }, 3500); // Total duration before main content fade starts
                 }, { once: true });
             } else {
                  // If splash screen doesn't exist (e.g., during development/testing)
                  mainContent.style.display = 'block';
                  mainContent.classList.add('visible');
                  document.body.style.overflow = 'auto';
                  setupScrollAnimations();
                  renderMainEquations();
                  // Check hash on initial load even without splash
                  if(window.location.hash === '#einstein-detail') {
                     showDetailPage();
                  }
             }


            // --- Detail Page Navigation ---
             if (einsteinLink) {
                einsteinLink.addEventListener('click', (e) => {
                     e.preventDefault(); // Prevent default anchor jump
                     showDetailPage();
                 });
             }
            
             if (backToMainLink) {
                 backToMainLink.addEventListener('click', (e) => {
                     e.preventDefault();
                     showMainContent();
                 });
             }
             
             // --- Home Link Navigation ---
             if (homeLink) {
                 homeLink.addEventListener('click', (e) => {
                      // If detail page is visible, go back to main content.
                      // Otherwise, just scroll to top (default link behavior).
                      if (detailPage.style.display === 'block') {
                           e.preventDefault();
                           showMainContent();
                      }
                 });
             }


            function setupScrollAnimations() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('.scroll-animated').forEach(target => {
                    observer.observe(target);
                });
            }

            // Renders equations in the main content cards (using KaTeX)
            function renderMainEquations() {
                 const equations = [
                    // Corrected Unicode escape sequences
                    { selector: '#field-equations .grid > div:nth-child(1) .equation-display', formula: `R_{\\mu\\nu} - \\frac{1}{2}g_{\\mu\\nu}R + \\Lambda g_{\\mu\\nu} = \\frac{8\\pi G}{c^4}T_{\\mu\\nu}` },
                    { selector: '#field-equations .grid > div:nth-child(2) .equation-display', formula: `ds^2 = -\\left(1-\\frac{2GM}{rc^2}\\right)c^2dt^2 + \\frac{dr^2}{1-\\frac{2GM}{rc^2}} + r^2 d\\Omega^2` },
                    { selector: '#field-equations .grid > div:nth-child(3) .equation-display', formula: `ds^2 = -\\left(1-\\frac{2GMr}{\\rho^2 c^2}\\right)c^2dt^2 - \\frac{4GMar\\sin^2\\theta}{\\rho^2 c}dtd\\phi + \\dots` }
                ];

                equations.forEach(eq => {
                    const element = document.querySelector(eq.selector);
                    if (element) {
                        try {
                           katex.render(eq.formula, element, {
                                throwOnError: false,
                                displayMode: true
                           });
                        } catch (error) {
                           console.error("KaTeX rendering error in main equation:", error);
                           element.textContent = "Error rendering equation.";
                        }
                    }
                });
            }
             
            // --- Simulation Logic ---
             if (massSlider && massValueSpan) {
                massSlider.addEventListener('input', () => {
                    massValueSpan.textContent = parseFloat(massSlider.value).toFixed(1);
                });
             }

             if (runSimulationBtn) {
                 runSimulationBtn.addEventListener('click', async () => {
                     simulationLoading.style.display = 'block'; 
                     simulationResults.innerHTML = ''; // Clear previous results
                     simulationError.style.display = 'none'; // Hide previous errors

                     const currentMass = massSlider ? massSlider.value : '10'; // Get mass from slider
                     
                     try {
                         // --- IMPORTANT ---
                         // Replace this URL with the actual address of your running Python Flask server
                         const apiUrl = `http://127.0.0.1:5000/run-simulation?mass=${currentMass}`;
                         console.log("Fetching from:", apiUrl); // Log the URL for debugging
                         const response = await fetch(apiUrl); 
                         
                         if (!response.ok) {
                              const errorText = await response.text(); // Get error details from server if available
                              throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
                         }
                         
                         const data = await response.json();

                         if (data.status === 'success' && data.image_data) {
                            // Create an image element and display the base64 data
                            const img = document.createElement('img');
                            img.src = data.image_data;
                            img.alt = `Spacetime Curvature Plot (Mass = ${data.mass_used})`;
                            simulationResults.appendChild(img);
                         } else {
                             throw new Error(data.message || 'Invalid response format from server.');
                         }
                         
                     } catch (error) {
                         console.error('Error fetching simulation results:', error);
                         simulationError.textContent = `Error: ${error.message}. Is the Python server running at http://12.0.0.1:5000? Check terminal for Python errors.`;
                         simulationError.style.display = 'block'; // Show error message
                         simulationResults.textContent = 'Failed to load simulation plot.'; // Show placeholder in results
                     } finally {
                         simulationLoading.style.display = 'none'; // Hide loading
                     }
                 });
             }

        });
    </script>

</body>
</html>

